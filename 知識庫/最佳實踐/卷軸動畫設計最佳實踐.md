# 卷軸動畫設計最佳實踐

## 設計背景

**來源**: `f62a0ee0` - Supabase Schema Fixes / `bf5a9afd` - 卷軸展開動態展示  
**專案**: 福至心靈籤  
**目標**: 創造莊嚴、流暢的卷軸展開體驗

## 核心設計原則

### 1. 自然優於炫技

**錯誤示範**: 過度複雜的旋轉動畫
```css
/* ❌ 使用者反饋: "卷軸旋轉,不如原來由上而下展開來得自然" */
@keyframes scroll-unroll-rotate {
  from {
    transform: rotateX(-90deg) scaleY(0);
  }
  to {
    transform: rotateX(0deg) scaleY(1);
  }
}
```

**正確做法**: 簡單的垂直展開
```css
/* ✅ 自然的由上而下展開 */
@keyframes scroll-unroll {
  from {
    max-height: 0;
    opacity: 0;
  }
  to {
    max-height: 20000px;
    opacity: 1;
  }
}

.scroll-content {
  animation: scroll-unroll 2.2s cubic-bezier(0.1, 0, 0.3, 1) forwards;
  transform-origin: top center;
}
```

**關鍵要點**:
- ✅ 垂直展開符合物理直覺
- ✅ 使用者更容易理解
- ✅ 不會造成視覺疲勞

### 2. 時間掌控

**使用者需求**: "要讓使用者看到下卷軸由上而下慢慢展開過程至少2秒"

#### 動畫時長設計

```css
/* 展開動畫: 2.2秒 */
.scroll-unroll {
  animation-duration: 2.2s;
}

/* 內容淡入: 2.5秒 (略晚於展開) */
.content-fade-in {
  animation: fadeIn 0.8s ease-out 2.5s forwards;
  opacity: 0;
}

/* 捐款動畫: 5秒 (完整體驗) */
.blessing-animation {
  animation-duration: 5s;
}
```

**時間層次**:
1. **0-2.2s**: 卷軸展開
2. **2.5-3.3s**: 內容淡入
3. **互動後**: 捐款動畫 (5s)

### 3. 緩動曲線 (Easing)

```css
/* 不同階段使用不同緩動 */

/* 展開: 緩入緩出,模擬重力 */
cubic-bezier(0.1, 0, 0.3, 1)

/* 淡入: 簡單緩出 */
ease-out

/* 捐款粒子: 線性上升 */
linear
```

**緩動選擇指南**:

| 動畫類型 | 緩動函數 | 理由 |
|----------|----------|------|
| 卷軸展開 | `cubic-bezier(0.1, 0, 0.3, 1)` | 模擬真實展開,開始慢後加速 |
| 文字淡入 | `ease-out` | 快速出現後減速,吸引注意 |
| 粒子上升 | `linear` | 持續穩定,營造莊嚴感 |
| 按鈕hover | `ease-in-out` | 平滑過渡,不突兀 |

## 實戰案例

### 案例 1: 卷軸展開動畫

#### 需求演進

```
使用者需求 1: "卷軸向下展開的動畫要從螢幕上方1/4位置向下展開"
→ 實作: 加入 mt-[15vh]

使用者反饋: "改回去"
→ 理解: 使用者要的是「展開過程」而非「起始位置」

使用者需求 2: "我指的是要讓使用者看到下卷軸由上而下慢慢展開過程至少2秒"
→ 實作: 延長動畫時間到 2.2秒

使用者需求 3: "上卷軸位置不要動"
→ 實作: transform-origin: top center
```

#### 最終實作

```css
/* index.css */
@keyframes scroll-unroll {
  from {
    max-height: 0;
    opacity: 0;
    overflow: hidden;
  }
  to {
    max-height: 20000px;
    opacity: 1;
    overflow: visible;
  }
}

.scroll-content {
  animation: scroll-unroll 2.2s cubic-bezier(0.1, 0, 0.3, 1) forwards;
  transform-origin: top center;
}

/* 內容延遲淡入 */
@keyframes content-fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

.scroll-inner-content {
  animation: content-fade-in 0.8s ease-out 2.5s forwards;
  opacity: 0;
}
```

## 常見問題與解決方案

### 問題 1: 動畫被卷軸遮擋

**現象**: 捐款動畫看不到,只看到卷軸重新展開

**原因**: z-index 層級不足,被 ScrollLayout 遮擋

**解決方案**:
```tsx
// 將動畫移到最外層,使用極高 z-index
<div className="fixed inset-0 z-[9999]">
  <BlessingAnimation />
</div>
```

### 問題 2: 服務須知下方顯示不完整

**現象**: 內容被截斷,無法滾動到底部

**原因**: `max-height` 限制過小

**解決方案**:
```css
/* 從 1200px 提升到 20000px */
@keyframes scroll-unroll {
  to {
    max-height: 20000px;
    overflow: visible;
  }
}
```

### 問題 3: 動畫收尾太急

**現象**: 動畫突然消失,不夠柔和

**解決方案**:
```css
/* 延長淡出階段,加入模糊效果 */
@keyframes blessing-text {
  70% {
    opacity: 1;
  }
  100% {
    opacity: 0;
    filter: blur(12px);
  }
}
```

## 效能優化

### 1. 使用 CSS 動畫而非 JavaScript

```css
/* ✅ 好: CSS 動畫,GPU 加速 */
.scroll-content {
  animation: scroll-unroll 2.2s ease-out;
  will-change: max-height, opacity;
}
```

### 2. 限制粒子數量

```tsx
/* ✅ 適中: 30 個粒子 */
{Array.from({ length: 30 }).map(...)}
```

### 3. 使用 transform 而非 position

```css
/* ✅ 好: transform,GPU 加速 */
transform: translateY(-100vh);
```

## 設計檢查清單

```markdown
- [ ] 動畫時長至少 2 秒
- [ ] 使用自然的緩動曲線
- [ ] 上卷軸位置固定
- [ ] 內容淡入延遲於展開完成
- [ ] 動畫層級正確 (z-index: 9999)
- [ ] 收尾柔和 (加入 blur 效果)
- [ ] 支援長內容滾動
- [ ] 效能優化 (CSS 動畫 + GPU 加速)
```

## 標籤

#最佳實踐 #動畫設計 #CSS #使用者體驗 #效能優化

## 專案

福至心靈籤

## 相關對話

- `f62a0ee0` - Supabase Schema Fixes (2025-12-21)
- `bf5a9afd` - 卷軸展開動態展示 (2025-12-20)
